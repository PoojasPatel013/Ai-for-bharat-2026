============================= test session starts ==============================
platform linux -- Python 3.10.12, pytest-7.4.4, pluggy-1.6.0 -- /home/fierypooja/.cache/pypoetry/virtualenvs/ai-doc-healing-jmbp0ghN-py3.10/bin/python
cachedir: .pytest_cache
hypothesis profile 'default'
rootdir: /home/fierypooja/hackproject
configfile: pytest.ini
plugins: anyio-4.12.1, hypothesis-6.151.9, asyncio-0.23.8, cov-4.1.0
asyncio: mode=auto
collecting ... collected 118 items

tests/test_api_endpoints.py::test_github_webhook_endpoint PASSED
tests/test_api_endpoints.py::test_gitlab_webhook_endpoint PASSED
tests/test_api_endpoints.py::test_validate_snippet_endpoint PASSED
tests/test_api_endpoints.py::test_validate_file_endpoint PASSED
tests/test_api_endpoints.py::test_heal_snippet_endpoint PASSED
tests/test_api_endpoints.py::test_heal_file_endpoint PASSED
tests/test_api_endpoints.py::test_webhook_endpoint_with_invalid_payload PASSED
tests/test_api_endpoints.py::test_validation_endpoint_with_missing_fields PASSED
tests/test_api_endpoints_properties.py::test_property_webhook_endpoint_availability[payload0] PASSED
tests/test_api_endpoints_properties.py::test_property_webhook_endpoint_availability[payload1] PASSED
tests/test_api_endpoints_properties.py::test_property_webhook_endpoint_availability[payload2] PASSED
tests/test_api_endpoints_properties.py::test_property_validation_functionality[payload0] PASSED
tests/test_api_endpoints_properties.py::test_property_validation_functionality[payload1] PASSED
tests/test_api_endpoints_properties.py::test_property_validation_functionality[payload2] PASSED
tests/test_api_endpoints_properties.py::test_property_healing_functionality[payload0] PASSED
tests/test_api_endpoints_properties.py::test_property_healing_functionality[payload1] PASSED
tests/test_api_startup.py::test_api_startup_lightweight_mode PASSED
tests/test_api_startup.py::test_api_startup_full_mode PASSED
tests/test_api_startup.py::test_api_startup_logging PASSED
tests/test_config.py::test_default_settings PASSED
tests/test_config.py::test_lightweight_mode_configuration PASSED
tests/test_config.py::test_full_mode_configuration PASSED
tests/test_config.py::test_hybrid_mode_configuration PASSED
tests/test_config.py::test_worker_configuration PASSED
tests/test_config.py::test_redis_configuration PASSED
tests/test_config.py::test_api_configuration PASSED
tests/test_config.py::test_get_settings_singleton PASSED
tests/test_connection.py::TestDatabaseConnectionFactory::test_get_database_url_postgresql PASSED
tests/test_connection.py::TestDatabaseConnectionFactory::test_get_database_url_sqlite PASSED
tests/test_connection.py::TestDatabaseConnectionFactory::test_create_db_engine_sqlite PASSED
tests/test_connection.py::TestDatabaseConnectionFactory::test_create_db_engine_postgresql PASSED
tests/test_connection.py::TestDatabaseConnectionFactory::test_get_db_yields_session PASSED
tests/test_connection.py::TestDatabaseConnectionFactory::test_get_db_closes_session_on_exit PASSED
tests/test_deployment_configs.py::test_docker_compose_lightweight_valid PASSED
tests/test_deployment_configs.py::test_environment_templates_complete PASSED
tests/test_deployment_configs.py::test_makefile_commands_present PASSED
tests/test_memory_backend.py::test_memory_backend_initialization_sync PASSED
tests/test_memory_backend.py::test_memory_backend_initialization_async PASSED
tests/test_memory_backend.py::test_enqueue_sync_executes_immediately PASSED
tests/test_memory_backend.py::test_enqueue_sync_raises_on_error PASSED
tests/test_memory_backend.py::test_enqueue_async_queues_task PASSED
tests/test_memory_backend.py::test_enqueue_async_handles_errors PASSED
tests/test_memory_backend.py::test_get_queue_creates_queue_once PASSED
tests/test_memory_backend.py::test_get_queue_creates_different_queues PASSED
tests/test_memory_backend.py::test_get_task_returns_none_for_empty_queue PASSED
tests/test_memory_backend.py::test_get_task_returns_queued_task PASSED
tests/test_memory_backend.py::test_get_task_with_timeout PASSED
tests/test_memory_backend.py::test_mark_complete_removes_task PASSED
tests/test_memory_backend.py::test_mark_failed_removes_task PASSED
tests/test_memory_backend.py::test_multiple_tasks_async PASSED
tests/test_memory_backend.py::test_multiple_queues_async PASSED
tests/test_memory_backend.py::test_shutdown_stops_workers PASSED
tests/test_memory_backend.py::test_task_with_kwargs PASSED
tests/test_memory_backend.py::test_concurrent_enqueue PASSED
tests/test_memory_backend_integration.py::test_sync_mode_immediate_execution PASSED
tests/test_memory_backend_integration.py::test_async_mode_worker_threads PASSED
tests/test_memory_backend_integration.py::test_multiple_queue_types PASSED
tests/test_memory_backend_integration.py::test_task_interface_consistency PASSED
tests/test_memory_backend_integration.py::test_no_persistence_across_restarts PASSED
tests/test_memory_backend_integration.py::test_error_handling_in_async_mode PASSED
tests/test_memory_backend_integration.py::test_graceful_shutdown PASSED
tests/test_memory_monitoring_properties.py::test_property_memory_metrics_logging PASSED
tests/test_migration_scripts.py::TestPostgresToSqliteMigration::test_migration_success PASSED
tests/test_migration_scripts.py::TestPostgresToSqliteMigration::test_migration_error_handling PASSED
tests/test_migration_scripts.py::TestSqliteToPostgresMigration::test_migration_success PASSED
tests/test_migration_scripts.py::TestSqliteToPostgresMigration::test_migration_error_handling PASSED
tests/test_models.py::test_repository_info_creation PASSED
tests/test_models.py::test_code_snippet_creation PASSED
tests/test_models.py::test_validation_result_success PASSED
tests/test_models.py::test_validation_result_failure PASSED
tests/test_queue_factory.py::test_get_queue_backend_returns_redis_backend PASSED
tests/test_queue_factory.py::test_get_queue_backend_returns_memory_backend PASSED
tests/test_queue_factory.py::test_get_queue_backend_returns_singleton PASSED
tests/test_queue_factory.py::test_reset_queue_backend_clears_singleton PASSED
tests/test_queue_factory.py::test_reset_queue_backend_calls_shutdown_on_memory_backend PASSED
tests/test_queue_factory.py::test_reset_queue_backend_does_not_call_shutdown_on_redis_backend PASSED
tests/test_queue_factory.py::test_factory_logs_backend_initialization PASSED
tests/test_queue_factory.py::test_factory_with_redis_backend_configuration PASSED
tests/test_queue_factory.py::test_factory_with_memory_backend_configuration PASSED
tests/test_queue_factory.py::test_reset_queue_backend_when_none_exists PASSED
tests/test_redis_backend.py::test_redis_backend_initialization PASSED
tests/test_redis_backend.py::test_enqueue_creates_task PASSED
tests/test_redis_backend.py::test_enqueue_calls_rq_enqueue PASSED
tests/test_redis_backend.py::test_get_queue_creates_queue_once PASSED
tests/test_redis_backend.py::test_get_queue_creates_different_queues PASSED
tests/test_redis_backend.py::test_get_task_returns_none_for_empty_queue PASSED
tests/test_redis_backend.py::test_get_task_returns_first_task PASSED
tests/test_redis_backend.py::test_mark_complete_logs_completion PASSED
tests/test_redis_backend.py::test_mark_failed_logs_error PASSED
tests/test_redis_backend.py::test_mark_complete_raises_on_missing_job PASSED
tests/test_redis_backend.py::test_mark_failed_raises_on_missing_job PASSED
tests/test_task_processing_properties.py::test_property_task_processing_types You can add @seed(122905495286018993112500341047350368561) to this test or run pytest with --hypothesis-seed=122905495286018993112500341047350368561 to reproduce this failure.
FAILED
tests/test_unified_worker.py::test_unified_worker_initialization_sync PASSED
tests/test_unified_worker.py::test_unified_worker_initialization_async PASSED
tests/test_unified_worker.py::test_unified_worker_start_sync_mode PASSED
tests/test_unified_worker.py::test_unified_worker_start_async_mode PASSED
tests/test_unified_worker.py::test_unified_worker_stop PASSED
tests/test_unified_worker.py::test_unified_worker_stop_when_not_running PASSED
tests/test_unified_worker.py::test_unified_worker_signal_handler PASSED
tests/test_unified_worker.py::test_unified_worker_monitors_thread_health PASSED
tests/test_unified_worker.py::test_unified_worker_redis_mode_placeholder PASSED
tests/test_unified_worker.py::test_unified_worker_task_routing PASSED
tests/test_unified_worker.py::test_unified_worker_error_handling PASSED
tests/test_unified_worker.py::test_unified_worker_keyboard_interrupt PASSED
tests/test_worker_tasks.py::TestWebhookTasks::test_process_github_webhook_success PASSED
tests/test_worker_tasks.py::TestWebhookTasks::test_process_github_webhook_invalid_payload PASSED
tests/test_worker_tasks.py::TestWebhookTasks::test_process_github_webhook_missing_event_type PASSED
tests/test_worker_tasks.py::TestWebhookTasks::test_process_gitlab_webhook_success PASSED
tests/test_worker_tasks.py::TestWebhookTasks::test_process_gitlab_webhook_invalid_payload PASSED
tests/test_worker_tasks.py::TestValidationTasks::test_validate_code_snippet_success PASSED
tests/test_worker_tasks.py::TestValidationTasks::test_validate_code_snippet_missing_parameters PASSED
tests/test_worker_tasks.py::TestValidationTasks::test_validate_documentation_file_success PASSED
tests/test_worker_tasks.py::TestValidationTasks::test_validate_documentation_file_missing_parameters PASSED
tests/test_worker_tasks.py::TestHealingTasks::test_heal_code_snippet_success PASSED
tests/test_worker_tasks.py::TestHealingTasks::test_heal_code_snippet_missing_parameters PASSED
tests/test_worker_tasks.py::TestHealingTasks::test_heal_code_snippet_no_errors PASSED
tests/test_worker_tasks.py::TestHealingTasks::test_heal_documentation_file_success PASSED
tests/test_worker_tasks.py::TestHealingTasks::test_heal_documentation_file_missing_parameters PASSED

=================================== FAILURES ===================================
_____________________ test_property_task_processing_types ______________________

    @given(task=task_st)
>   @hy_settings(max_examples=50)

tests/test_task_processing_properties.py:24: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../.cache/pypoetry/virtualenvs/ai-doc-healing-jmbp0ghN-py3.10/lib/python3.10/site-packages/hypothesis/internal/conjecture/engine.py:967: in run
    self._run()
../.cache/pypoetry/virtualenvs/ai-doc-healing-jmbp0ghN-py3.10/lib/python3.10/site-packages/hypothesis/internal/conjecture/engine.py:1531: in _run
    self.reuse_existing_examples()
../.cache/pypoetry/virtualenvs/ai-doc-healing-jmbp0ghN-py3.10/lib/python3.10/site-packages/hypothesis/internal/conjecture/engine.py:1043: in reuse_existing_examples
    data = self.cached_test_function(choices, extend="full")
../.cache/pypoetry/virtualenvs/ai-doc-healing-jmbp0ghN-py3.10/lib/python3.10/site-packages/hypothesis/internal/conjecture/engine.py:508: in cached_test_function
    self.test_function(data)
../.cache/pypoetry/virtualenvs/ai-doc-healing-jmbp0ghN-py3.10/lib/python3.10/site-packages/hypothesis/internal/conjecture/engine.py:555: in test_function
    self.__stoppable_test_function(data)
../.cache/pypoetry/virtualenvs/ai-doc-healing-jmbp0ghN-py3.10/lib/python3.10/site-packages/hypothesis/internal/conjecture/engine.py:414: in __stoppable_test_function
    self._test_function(data)
../.cache/pypoetry/virtualenvs/ai-doc-healing-jmbp0ghN-py3.10/lib/python3.10/site-packages/hypothesis/core.py:1211: in _execute_once_for_engine
    result = self.execute_once(data)
../.cache/pypoetry/virtualenvs/ai-doc-healing-jmbp0ghN-py3.10/lib/python3.10/site-packages/hypothesis/core.py:1150: in execute_once
    result = self.test_runner(data, run)
../.cache/pypoetry/virtualenvs/ai-doc-healing-jmbp0ghN-py3.10/lib/python3.10/site-packages/hypothesis/core.py:824: in default_executor
    return function(data)
../.cache/pypoetry/virtualenvs/ai-doc-healing-jmbp0ghN-py3.10/lib/python3.10/site-packages/hypothesis/core.py:1054: in run
    kw, argslices = context.prep_args_kwargs_from_strategies(
../.cache/pypoetry/virtualenvs/ai-doc-healing-jmbp0ghN-py3.10/lib/python3.10/site-packages/hypothesis/control.py:219: in prep_args_kwargs_from_strategies
    kwargs[k] = self.data.draw(s, observe_as=f"generate:{k}")
../.cache/pypoetry/virtualenvs/ai-doc-healing-jmbp0ghN-py3.10/lib/python3.10/site-packages/hypothesis/internal/conjecture/data.py:1210: in draw
    v = unwrapped.do_draw(self)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = builds(Task, id=text(characters(codec='utf-8'), min_size=5, max_size=20), name=sampled_from(['validation', 'healing', ..._size=0, max_size=inf).map(dict), status=sampled_from(['queued', 'running', 'completed', 'failed']), queue_name=text())
data = ConjectureData(VALID, 7 choices, frozen)

    def do_draw(self, data: ConjectureData) -> Ex:
        context = current_build_context()
        arg_labels: ArgLabelsT = {}
    
        args = []
        for i, s in enumerate(self.args):
            with context.track_arg_label(f"arg[{i}]") as arg_label:
                args.append(data.draw(s))
            arg_labels |= arg_label
    
        kwargs = {}
        for k, v in self.kwargs.items():
            with context.track_arg_label(k) as arg_label:
                kwargs[k] = data.draw(v)
            arg_labels |= arg_label
    
        try:
>           obj = self.target(*args, **kwargs)
E           TypeError: Task.__init__() got an unexpected keyword argument 'name'
E           while generating 'task' from builds(Task, args=lists(one_of(text(), integers())), func_name=sampled_from(['validate_code_snippet', 'heal_code_snippet', 'process_github_webhook']), id=text(min_size=5, max_size=20), kwargs=dictionaries(keys=text(min_size=1), values=one_of(text(), integers(), floats(), booleans(), none())), name=sampled_from(['validation', 'healing', 'webhook']), status=sampled_from(['queued', 'running', 'completed', 'failed']))

../.cache/pypoetry/virtualenvs/ai-doc-healing-jmbp0ghN-py3.10/lib/python3.10/site-packages/hypothesis/strategies/_internal/core.py:1072: TypeError
---------------------------------- Hypothesis ----------------------------------
You can add @seed(122905495286018993112500341047350368561) to this test or run pytest with --hypothesis-seed=122905495286018993112500341047350368561 to reproduce this failure.
=============================== warnings summary ===============================
src/doc_healing/db/base.py:6
  /home/fierypooja/hackproject/src/doc_healing/db/base.py:6: MovedIn20Warning: The ``declarative_base()`` function is now available as sqlalchemy.orm.declarative_base(). (deprecated since: 2.0) (Background on SQLAlchemy 2.0 at: https://sqlalche.me/e/b8d9)
    Base = declarative_base()

tests/test_api_endpoints.py: 8 warnings
tests/test_api_startup.py: 3 warnings
  /home/fierypooja/hackproject/src/doc_healing/api/main.py:72: DeprecationWarning: 
          on_event is deprecated, use lifespan event handlers instead.
  
          Read more about it in the
          [FastAPI docs for Lifespan Events](https://fastapi.tiangolo.com/advanced/events/).
          
    @app.on_event("startup")

tests/test_api_endpoints.py: 8 warnings
tests/test_api_startup.py: 3 warnings
  /home/fierypooja/.cache/pypoetry/virtualenvs/ai-doc-healing-jmbp0ghN-py3.10/lib/python3.10/site-packages/fastapi/applications.py:4495: DeprecationWarning: 
          on_event is deprecated, use lifespan event handlers instead.
  
          Read more about it in the
          [FastAPI docs for Lifespan Events](https://fastapi.tiangolo.com/advanced/events/).
          
    return self.router.on_event(event_type)

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html

---------- coverage: platform linux, python 3.10.12-final-0 ----------
Name                                      Stmts   Miss  Cover   Missing
-----------------------------------------------------------------------
src/doc_healing/__init__.py                   1      0   100%
src/doc_healing/api/__init__.py               0      0   100%
src/doc_healing/api/main.py                 128     19    85%   101, 140-142, 173-175, 215-217, 253-255, 296-298, 334-336
src/doc_healing/aws/__init__.py               0      0   100%
src/doc_healing/aws/secrets.py               21     21     0%   1-44
src/doc_healing/config.py                    35      0   100%
src/doc_healing/db/__init__.py                4      0   100%
src/doc_healing/db/base.py                    2      0   100%
src/doc_healing/db/connection.py             24      0   100%
src/doc_healing/db/models.py                142      0   100%
src/doc_healing/llm/__init__.py               0      0   100%
src/doc_healing/llm/bedrock_client.py        32     11    66%   48-55, 58-65
src/doc_healing/llm/prompts.py                3      0   100%
src/doc_healing/models/__init__.py            8      0   100%
src/doc_healing/models/base.py               29      0   100%
src/doc_healing/models/config.py             38      0   100%
src/doc_healing/models/healing.py            15      0   100%
src/doc_healing/models/mapping.py            41      0   100%
src/doc_healing/models/orchestration.py      40      0   100%
src/doc_healing/models/validation.py         36      0   100%
src/doc_healing/models/webhook.py            11      0   100%
src/doc_healing/monitoring/__init__.py        0      0   100%
src/doc_healing/monitoring/memory.py         16      0   100%
src/doc_healing/queue/__init__.py             4      0   100%
src/doc_healing/queue/base.py                23      4    83%   55, 73, 86, 100
src/doc_healing/queue/factory.py             26      0   100%
src/doc_healing/queue/memory_backend.py     105      1    99%   262
src/doc_healing/queue/queue_manager.py       21      9    57%   23, 36, 49, 62, 77, 92, 107-109
src/doc_healing/queue/redis_backend.py       48      0   100%
src/doc_healing/queue/redis_client.py        12      3    75%   20-28
src/doc_healing/workers/__init__.py           0      0   100%
src/doc_healing/workers/tasks.py             76      6    92%   84, 272-273, 295-297
src/doc_healing/workers/unified.py           87      2    98%   118, 221
-----------------------------------------------------------------------
TOTAL                                      1028     76    93%
Coverage HTML written to dir htmlcov
Coverage XML written to file coverage.xml

=========================== short test summary info ============================
FAILED tests/test_task_processing_properties.py::test_property_task_processing_types
================= 1 failed, 117 passed, 23 warnings in 35.50s ==================
